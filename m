Return-Path: <linux-scsi-owner@vger.kernel.org>
X-Original-To: lists+linux-scsi@lfdr.de
Delivered-To: lists+linux-scsi@lfdr.de
Received: from vger.kernel.org (vger.kernel.org [23.128.96.18])
	by mail.lfdr.de (Postfix) with ESMTP id 454624AF8D7
	for <lists+linux-scsi@lfdr.de>; Wed,  9 Feb 2022 18:57:44 +0100 (CET)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S235059AbiBIR5j (ORCPT <rfc822;lists+linux-scsi@lfdr.de>);
        Wed, 9 Feb 2022 12:57:39 -0500
Received: from lindbergh.monkeyblade.net ([23.128.96.19]:51958 "EHLO
        lindbergh.monkeyblade.net" rhost-flags-OK-OK-OK-OK) by vger.kernel.org
        with ESMTP id S232353AbiBIR5i (ORCPT
        <rfc822;linux-scsi@vger.kernel.org>); Wed, 9 Feb 2022 12:57:38 -0500
Received: from mx0b-00069f02.pphosted.com (mx0b-00069f02.pphosted.com [205.220.177.32])
        by lindbergh.monkeyblade.net (Postfix) with ESMTPS id D8C17C0613C9
        for <linux-scsi@vger.kernel.org>; Wed,  9 Feb 2022 09:57:39 -0800 (PST)
Received: from pps.filterd (m0246632.ppops.net [127.0.0.1])
        by mx0b-00069f02.pphosted.com (8.16.1.2/8.16.1.2) with SMTP id 219HD6vJ013525;
        Wed, 9 Feb 2022 17:57:33 GMT
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=oracle.com; h=from : to : cc :
 subject : date : message-id : references : in-reply-to : content-type :
 content-id : content-transfer-encoding : mime-version; s=corp-2021-07-09;
 bh=1qAaCthJZrRb3GlKdq88vYQS6x19/B6Jp8ZJyd29K4E=;
 b=WEQIOU6+1EqAcEH2Uh/b7AzKTYxp8Arr92zf//xrkdvBCDp9B00yOnWfW7v4rCOl/Xc7
 CYLbVyP7eRX14uVVgESaDD827HhJOT6B95M3FaKhMtxr+WwKLUYoDAzJSVN+1pfjFM9H
 MZ4DAXZ5bgf//ULkgzqenHSGTPwSK3bia+O/7sPgquRMMGRuH4cDuyLc3SKQpA5Kh1Wl
 STPoChGUxkpT5bvzDnEy7lm4VO45qTkEAUux4UbBzA3/vXpWQyHn/U6vUN16drCkJmlO
 wQQQqCn3hCCCDcUMYq7JWgl/xgVZnmBpak+Tyc6QF59860op39qcaBz8IKOd2ifPgP2j 4w== 
Received: from aserp3030.oracle.com (aserp3030.oracle.com [141.146.126.71])
        by mx0b-00069f02.pphosted.com with ESMTP id 3e345sq9gm-1
        (version=TLSv1.2 cipher=ECDHE-RSA-AES256-GCM-SHA384 bits=256 verify=OK);
        Wed, 09 Feb 2022 17:57:33 +0000
Received: from pps.filterd (aserp3030.oracle.com [127.0.0.1])
        by aserp3030.oracle.com (8.16.1.2/8.16.1.2) with SMTP id 219HaSR3167542;
        Wed, 9 Feb 2022 17:57:32 GMT
Received: from nam11-bn8-obe.outbound.protection.outlook.com (mail-bn8nam11lp2174.outbound.protection.outlook.com [104.47.58.174])
        by aserp3030.oracle.com with ESMTP id 3e1f9hs0p0-1
        (version=TLSv1.2 cipher=ECDHE-RSA-AES256-GCM-SHA384 bits=256 verify=OK);
        Wed, 09 Feb 2022 17:57:32 +0000
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=fih3asS6r2TKIErAM8c3UfbxvF5iWAbgyE0j7ZKS8C848U636AgY98tDLeA41+sVXXdbJ3AFuo1fqjr/R9qmsItvwaKcc5QXX4mMrw9tooFHBTErzSXgaR852xebRso2QG9aiKe52V9JqtwP4IXhZPNJCEG/ini7XVyIQPxjJMTR6eiqJCtfamH/0yxk5ooE6vL4i1Q4Tdu+a0JuiKtL1ipycuGJTHzEPfguvRJVGlMo5OabmcsMGmdWcNq+npOrHxQQC2SqPNTxC/zREqjRln3czcVSvzjFz6sVfjYVCn+BPT1XXgX1rg0Fp8Re0fJIOs8RwD9bsQXZNvkxyDF0bg==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com;
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-AntiSpam-MessageData-ChunkCount:X-MS-Exchange-AntiSpam-MessageData-0:X-MS-Exchange-AntiSpam-MessageData-1;
 bh=1qAaCthJZrRb3GlKdq88vYQS6x19/B6Jp8ZJyd29K4E=;
 b=gkE3pkin2HFys+YN9vGoJ4KPyZmOjF+eL/QgXFNfIOXn8KcAhG7vG58ePnmlJqh1th6ImhzgFMPElj7K5kf7uQfeqsTIb8GxmVbc3Ftfyv2X982BGA2LPaA/Hpne8ENWR6k8bUkfkd7Aw8q2LLZqE1ZI2LSFzJ6iEpAznDuqPQhdnWQGc6nAmYRV/aq6c8gXXP0kMoAp/HZxlDD/pc74tD6a0oROLob90g2CO4WNuyp/JQHVlqZS4qiQ361JU7vFOYxwT0LEdaDcKQFw1xlFJWszmwTHX2pHeRtu9UQmJ3eiYlriMITkfIcoB3u2iHLw3LMJhTK7vfWk7lv1O4I/ZA==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=none; dmarc=none;
 dkim=none; arc=none
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=oracle.onmicrosoft.com; s=selector2-oracle-onmicrosoft-com;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=1qAaCthJZrRb3GlKdq88vYQS6x19/B6Jp8ZJyd29K4E=;
 b=dFyttKjEFiz3lsu47VLEzKlqSD1ZPJENG5iMNHFpJMLfJsCBERIQdrMTrfth1E2M1V3X//RtL1WlxMhZxgHtf8IogbjP2D8EZ4XwyURNwD1y1qNGBHQ7YdkpQEnydQHshq3K0AQxgNnCrTROnifAwuT/MPSPDbl/u2Nb2V4vQV4=
Received: from SN6PR10MB2943.namprd10.prod.outlook.com (2603:10b6:805:d4::19)
 by CY4PR1001MB2264.namprd10.prod.outlook.com (2603:10b6:910:43::33) with
 Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.4951.18; Wed, 9 Feb
 2022 17:57:29 +0000
Received: from SN6PR10MB2943.namprd10.prod.outlook.com
 ([fe80::755b:8fbf:706a:858]) by SN6PR10MB2943.namprd10.prod.outlook.com
 ([fe80::755b:8fbf:706a:858%4]) with mapi id 15.20.4951.019; Wed, 9 Feb 2022
 17:57:29 +0000
From:   Himanshu Madhani <himanshu.madhani@oracle.com>
To:     Bart Van Assche <bvanassche@acm.org>
CC:     Martin Petersen <martin.petersen@oracle.com>,
        linux-scsi <linux-scsi@vger.kernel.org>,
        Johannes Thumshirn <johannes.thumshirn@wdc.com>,
        "Juergen E. Fischer" <fischer@norbit.de>,
        "James E.J. Bottomley" <jejb@linux.ibm.com>
Subject: Re: [PATCH v2 12/44] aha152x: Move the SCSI pointer to private
 command data
Thread-Topic: [PATCH v2 12/44] aha152x: Move the SCSI pointer to private
 command data
Thread-Index: AQHYHRD4939ZI60nak+Bvc6zrdcWHayLgt4A
Date:   Wed, 9 Feb 2022 17:57:29 +0000
Message-ID: <1CF16B3E-FC5F-4F7E-9A72-211A5E6AB250@oracle.com>
References: <20220208172514.3481-1-bvanassche@acm.org>
 <20220208172514.3481-13-bvanassche@acm.org>
In-Reply-To: <20220208172514.3481-13-bvanassche@acm.org>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
x-mailer: Apple Mail (2.3693.40.0.1.81)
x-ms-publictraffictype: Email
x-ms-office365-filtering-correlation-id: 3fc19750-ed17-4582-7fcb-08d9ebf5a3c5
x-ms-traffictypediagnostic: CY4PR1001MB2264:EE_
x-microsoft-antispam-prvs: <CY4PR1001MB2264BE81845C55C722167080E62E9@CY4PR1001MB2264.namprd10.prod.outlook.com>
x-ms-oob-tlc-oobclassifiers: OLM:2331;
x-ms-exchange-senderadcheck: 1
x-ms-exchange-antispam-relay: 0
x-microsoft-antispam: BCL:0;
x-microsoft-antispam-message-info: PbGR3mSWRGbT5Gr0ZGBp5NAhU5EVMiYkrGv6maUePUjc8jL59Y2IZ/iUAJWx/HOZbFM4aQoX4hQA9YNAOsiTDFX6pdOo3N1b8lSHv2wbLFTNcntcsJSETHEbZWXkXS7XgFf9k1daeo/W1V9xhVuQ3Q/HUt1BNUd6qjRxw8Qxuh3k4qODkNlBNpnCTNGFuMd9zxsjc82wS+FOFPxU9GmUz89WiHqyKBSvbSV54B1JYcGwpUpa8pq5HN1tixzcm93C6ywTG0rLdTNoNZnNR66ykTUlOR4NuKA60CJlDdCRbuukllnnsEGrQxlbIpFAqmZY6Fl2urmW/dQLeIyhHbhTJTsGwUb5mt/UYYnuhaXBovfr+vqgBxQT79st+ZlAWkR0cA5g1M1ALkH+oTm+T+fpy/GKveHvzSNiblz7x6NGHeXa2uT7cr8tBVXOuL6Z+6Xxa339uwoK8ScRu+zC1505h5uvIY0Vqp+KXisernjn/RdSZCePrUqsI9gbaRdEQQYb8LrlLb9Sw9WOjZamroIFTjltM+dTSkKYKnCzYJ8LJRUy1jBbaw4A3rcuKKtvHQRCSfxCBHY+AP2z/ynO6xHXzBB48f2s9JXIv3/NqP5wQqKEHCwuVUXzLqClpelc/x+V5iFKylVGwTZNHf9x+XQYvYdxNPwsUuKWpCwz0D8e/gL7ozn7Gwm9iOjbTpQNpuaGVrWb5fg9l/oQFwhFowY6/pdYRzXtilE4eiXWGs7nQNpUNRnyDgiIfJltjamixJXc
x-forefront-antispam-report: CIP:255.255.255.255;CTRY:;LANG:en;SCL:1;SRV:;IPV:NLI;SFV:NSPM;H:SN6PR10MB2943.namprd10.prod.outlook.com;PTR:;CAT:NONE;SFS:(13230001)(366004)(54906003)(6512007)(36756003)(316002)(508600001)(71200400001)(6916009)(33656002)(38100700002)(2906002)(66476007)(66556008)(8676002)(2616005)(38070700005)(66946007)(66574015)(122000001)(66446008)(8936002)(4326008)(91956017)(30864003)(5660300002)(6486002)(53546011)(86362001)(64756008)(76116006)(186003)(83380400001)(6506007)(44832011)(45980500001)(579004)(559001);DIR:OUT;SFP:1101;
x-ms-exchange-antispam-messagedata-chunkcount: 1
x-ms-exchange-antispam-messagedata-0: =?utf-8?B?bzZpdy9XVCtkNDNiUCtGUUJjYU03YTY5MUN1cmVPTGsvQ1NqSW9zMHFCalRE?=
 =?utf-8?B?NGFOeFQxT0taN1doQWtHZFdBT21mVXMrZ1lRVUVhN1RRZ09SVlBpT044Y0Uz?=
 =?utf-8?B?VGZZSzlzRkFYTmpDSTVqZXgxd0tRaGRRdjJ3RTlkZjMvcSs0cm9rZjQ2OEN1?=
 =?utf-8?B?aFNZYU4rZVErNzQ0YUwxZGtYaTZXWFJsRm4rZXJENDJQeWp0amtiVjRZOThB?=
 =?utf-8?B?eWpLK1JwbjQ4eDArcWNvTGZPTzlyWWk1ZTFnTlBkY3ZRT0QyVHVCa3g4b2th?=
 =?utf-8?B?cEFGN00wTVI5ZG9HTEZjSHI4cFVpbmJnc04rQk0yd0VSV3ZDaktWWVlEdmJv?=
 =?utf-8?B?Ui96Rzh0aGsvN1BPSWJiOHVVUy93Wkd5NUo4M1U0enlJaEtFdlRneVpRNTlq?=
 =?utf-8?B?ZnEzcThKMGRqY1dwak9qRHRPMmdhNENUaUZqOXFLVktOVnMwNGVWSGFXZnY1?=
 =?utf-8?B?NmVLQjJnd0xJZGhSTEFhQ1JnUVJCY1VtRWVac3VYVmcxbUVQYk4yczJwRi9Q?=
 =?utf-8?B?bkhFdUNsWDlDeTJ3S2F5cndCZmMyWVlwNHlsMGJzNnllZWJzUEpqVW5CRnlt?=
 =?utf-8?B?K05rWHpZNEhEME54YXlZMGFjaWY4VXA2RzNFY1J2QmwwSlRoRWRXWWpPclRa?=
 =?utf-8?B?UmNuMkxGNVdDRTRoTTVsRUU4VWVIT1lOZXNmeXc4L2xWZFczTWxxcHZaZEZv?=
 =?utf-8?B?TjN0WjFMc2x0aTFZU1FtQnFqV1d0ZURJWUtYdytCOTJneWFGVzZTVGFXUHVO?=
 =?utf-8?B?SGJwWDllb0JOUzNWNlNaOVNxeWNHQ0pkVTJJeG1RV0R5SGIwZWxFdG9UVWtQ?=
 =?utf-8?B?TGdRNU5lSDFkVEhHakJnbnYwb2NVRGk3Y3RoNkoxV3d2ZTFRVG91bi9ncEVY?=
 =?utf-8?B?d2M3Y0ZkZ3pvaHFtVXhsVnNXZElNcUNLRFBzd2JLbU9IL3lZbFVlZFBhVi9h?=
 =?utf-8?B?cTU1TjlKaTV5T1p4dmJVS2lhcTdTQSt2Tkk0dDRYZzd2OTltZUQxTUFzUFd4?=
 =?utf-8?B?MTlieW5oSjlwRkxkeDk4T3pGOStSckdGTlR5cXRXSE43NnhrRG1kTjIzN3dJ?=
 =?utf-8?B?QlZaZlJUaXFBRWcvTXhsRnVmM09zWElwMVVOcmdoOEFLNjRqNFBENTNocXZv?=
 =?utf-8?B?TEtWWFNGeGtuYllvRTVKeWNsRThPdFVWZnJEeE55UXQ1QlN2OGVPVDg3Rlkx?=
 =?utf-8?B?WXlYVXdKcTQwZWprcnlSUWFycWxkOXhLWjUwRmkvRUo4MTBpRDNQNTB5WVN2?=
 =?utf-8?B?UXk2YmU5VGZXNWs3QktaRVZSRHRPZDFpZW5kV3pJSXhha1A0Y2F2NnNGck5X?=
 =?utf-8?B?ZTdxUklsdFQwTXBhbFdQTFRZSFE1WW1ZZXNzMHNLTTdBbEgzR2o2ZzRpMjZH?=
 =?utf-8?B?UWNjTGFqaGtnWkZxTFltd0xLcDJwbnBIUDYxQndXV0hMNUx4RnE0RysyYjBt?=
 =?utf-8?B?V1JGTStyNXQ5OExSQzhMb2JyRTh5Qy9zcFYrRURZakIxSGIvUkxmbDVlMEpH?=
 =?utf-8?B?aXphOWVvL1lFdG9IcFBBUUgvNFFzL3FVcGJsNEtFTzJacHNQSlVwUWtJTWN1?=
 =?utf-8?B?ZTJ2SWE2blJ4L1F2cTV2SmhUT1J5Y0hndUwyeGQ3N25rcFNGNVJlNk9Hekp3?=
 =?utf-8?B?T2xIV2toZE5WSTRobEV5VmlzRHhTZHQ5aitSSDZaczBhTURLb1B5MkZwSXNJ?=
 =?utf-8?B?UjliUThaWkx0SytVOHpnT0o3NUUvQmlyNGxyMDRRQzlJbnlYb1E5dm11Vm5h?=
 =?utf-8?B?eEV4eGRTWDE3RlRhOXg2aFZEMzdMSWU0eXAvZWN6WmxFdER5aVJkdGI5dlF5?=
 =?utf-8?B?RFNtVmpXT29DYXRkVHJUdHgzRXpnenB2ZWorNGtXb2pLQkZZSFVtV3gzcVVw?=
 =?utf-8?B?UlVFeDdzRXJPaThETHJqb2FMTUxaazhlZ2tmN1pnOHVPK0k3Z3l0ck1DdE0z?=
 =?utf-8?B?NmtxSnkyazFIdVB0V1dwVHF3QWxYbVN4cHRjS1lpTEpLVTBsVEpkSllPWUtL?=
 =?utf-8?B?QzhHK2ZzdmNIRm9LemxON1dhK0JNdWtsMS9qMUt5dWN2dWlPNUhaNjNtRHQy?=
 =?utf-8?B?NExBSFhHYmtTRDE3eUdZZ0lqcG5sWUlreGc3c0gzbGNXdEtQdGFRbTNHVFpQ?=
 =?utf-8?B?aE5BdFhpZGk4OVBDWm9WWXEyUjBRNUdZMUtWdlR4MFNZcC9kcGpNOUI5blRM?=
 =?utf-8?B?Q3MvZVpRQmhJM0JjOG1QSWZaWGZjblVxUWxpSVhyZ2VpdmNoaVBnWHk4Sk1h?=
 =?utf-8?B?Zmx0L1N1ejIvSkRBSDJDV29VNFJPS1hSVGVlYS9CYWIxS0R3TG4zTXVCYjlz?=
 =?utf-8?Q?Am36Pom6tDuyizH4NO?=
Content-Type: text/plain; charset="utf-8"
Content-ID: <75E1263C5BF000498DD3B0DFA08EC02F@namprd10.prod.outlook.com>
Content-Transfer-Encoding: base64
MIME-Version: 1.0
X-OriginatorOrg: oracle.com
X-MS-Exchange-CrossTenant-AuthAs: Internal
X-MS-Exchange-CrossTenant-AuthSource: SN6PR10MB2943.namprd10.prod.outlook.com
X-MS-Exchange-CrossTenant-Network-Message-Id: 3fc19750-ed17-4582-7fcb-08d9ebf5a3c5
X-MS-Exchange-CrossTenant-originalarrivaltime: 09 Feb 2022 17:57:29.3499
 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: 4e2c6054-71cb-48f1-bd6c-3a9705aca71b
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-CrossTenant-userprincipalname: QA05J2jz1yU3cXOslPI67Aj/Y0HsmHuyQTrBe2SL46InY1bfW1q3Dge1HLaP4lio18lTZs3Z1lGGCej+pEUbvUkgDQ3ji35mNV4jbSk6N50=
X-MS-Exchange-Transport-CrossTenantHeadersStamped: CY4PR1001MB2264
X-Proofpoint-Virus-Version: vendor=nai engine=6300 definitions=10252 signatures=673431
X-Proofpoint-Spam-Details: rule=notspam policy=default score=0 bulkscore=0 spamscore=0 adultscore=0
 mlxlogscore=999 suspectscore=0 mlxscore=0 phishscore=0 malwarescore=0
 classifier=spam adjust=0 reason=mlx scancount=1 engine=8.12.0-2201110000
 definitions=main-2202090096
X-Proofpoint-GUID: cSOFkl-mV-lYFtUEzGzhbHnO5lyGHIi6
X-Proofpoint-ORIG-GUID: cSOFkl-mV-lYFtUEzGzhbHnO5lyGHIi6
X-Spam-Status: No, score=-2.8 required=5.0 tests=BAYES_00,DKIM_SIGNED,
        DKIM_VALID,DKIM_VALID_AU,DKIM_VALID_EF,RCVD_IN_DNSWL_LOW,
        RCVD_IN_MSPIKE_H5,RCVD_IN_MSPIKE_WL,SPF_HELO_NONE,SPF_NONE,
        T_SCC_BODY_TEXT_LINE autolearn=ham autolearn_force=no version=3.4.6
X-Spam-Checker-Version: SpamAssassin 3.4.6 (2021-04-09) on
        lindbergh.monkeyblade.net
Precedence: bulk
List-ID: <linux-scsi.vger.kernel.org>
X-Mailing-List: linux-scsi@vger.kernel.org

DQoNCj4gT24gRmViIDgsIDIwMjIsIGF0IDk6MjQgQU0sIEJhcnQgVmFuIEFzc2NoZSA8YnZhbmFz
c2NoZUBhY20ub3JnPiB3cm90ZToNCj4gDQo+IFNldCAuY21kX3NpemUgaW4gdGhlIFNDU0kgaG9z
dCB0ZW1wbGF0ZSBpbnN0ZWFkIG9mIHVzaW5nIHRoZSBTQ1NJIHBvaW50ZXINCj4gZnJvbSBzdHJ1
Y3Qgc2NzaV9jbW5kLiBUaGlzIHBhdGNoIHByZXBhcmVzIGZvciByZW1vdmFsIG9mIHRoZSBTQ1NJ
IHBvaW50ZXINCj4gZnJvbSBzdHJ1Y3Qgc2NzaV9jbW5kLg0KPiANCj4gUmV2aWV3ZWQtYnk6IEpv
aGFubmVzIFRodW1zaGlybiA8am9oYW5uZXMudGh1bXNoaXJuQHdkYy5jb20+DQo+IFNpZ25lZC1v
ZmYtYnk6IEJhcnQgVmFuIEFzc2NoZSA8YnZhbmFzc2NoZUBhY20ub3JnPg0KPiAtLS0NCj4gZHJp
dmVycy9zY3NpL2FoYTE1MnguYyB8IDI1OSArKysrKysrKysrKysrKysrKysrKysrKystLS0tLS0t
LS0tLS0tLS0tLQ0KPiAxIGZpbGUgY2hhbmdlZCwgMTU1IGluc2VydGlvbnMoKyksIDEwNCBkZWxl
dGlvbnMoLSkNCj4gDQo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL3Njc2kvYWhhMTUyeC5jIGIvZHJp
dmVycy9zY3NpL2FoYTE1MnguYw0KPiBpbmRleCA5MDFiNzhlOGZmZTYuLjM0YjIzNzgwNzVmZCAx
MDA2NDQNCj4gLS0tIGEvZHJpdmVycy9zY3NpL2FoYTE1MnguYw0KPiArKysgYi9kcml2ZXJzL3Nj
c2kvYWhhMTUyeC5jDQo+IEBAIC0zMTYsNiArMzE2LDE3IEBAIGVudW0gew0KPiAJY2hlY2tfY29u
ZGl0aW9uID0gMHgwODAwLAkvKiByZXF1ZXN0aW5nIHNlbnNlIGFmdGVyIENIRUNLIENPTkRJVElP
TiAqLw0KPiB9Ow0KPiANCj4gK3N0cnVjdCBhaGExNTJ4X2NtZF9wcml2IHsNCj4gKwlzdHJ1Y3Qg
c2NzaV9wb2ludGVyIHNjc2lfcG9pbnRlcjsNCj4gK307DQo+ICsNCj4gK3N0YXRpYyBzdHJ1Y3Qg
c2NzaV9wb2ludGVyICphaGExNTJ4X3Njc2lfcG9pbnRlcihzdHJ1Y3Qgc2NzaV9jbW5kICpjbWQp
DQo+ICt7DQo+ICsJc3RydWN0IGFoYTE1MnhfY21kX3ByaXYgKmFjbWQgPSBzY3NpX2NtZF9wcml2
KGNtZCk7DQo+ICsNCj4gKwlyZXR1cm4gJmFjbWQtPnNjc2lfcG9pbnRlcjsNCj4gK30NCj4gKw0K
PiBNT0RVTEVfQVVUSE9SKCJKw7xyZ2VuIEZpc2NoZXIiKTsNCj4gTU9EVUxFX0RFU0NSSVBUSU9O
KEFIQTE1MlhfUkVWSUQpOw0KPiBNT0RVTEVfTElDRU5TRSgiR1BMIik7DQo+IEBAIC04NzksMTQg
Kzg5MCwxNyBAQCB2b2lkIGFoYTE1MnhfcmVsZWFzZShzdHJ1Y3QgU2NzaV9Ib3N0ICpzaHBudCkN
Cj4gc3RhdGljIGludCBzZXR1cF9leHBlY3RlZF9pbnRlcnJ1cHRzKHN0cnVjdCBTY3NpX0hvc3Qg
KnNocG50KQ0KPiB7DQo+IAlpZihDVVJSRU5UX1NDKSB7DQo+IC0JCUNVUlJFTlRfU0MtPlNDcC5w
aGFzZSB8PSAxIDw8IDE2Ow0KPiArCQlzdHJ1Y3Qgc2NzaV9wb2ludGVyICpzY3NpX3BvaW50ZXIg
PQ0KPiArCQkJYWhhMTUyeF9zY3NpX3BvaW50ZXIoQ1VSUkVOVF9TQyk7DQo+IA0KPiAtCQlpZihD
VVJSRU5UX1NDLT5TQ3AucGhhc2UgJiBzZWxlY3RpbmcpIHsNCj4gKwkJc2NzaV9wb2ludGVyLT5w
aGFzZSB8PSAxIDw8IDE2Ow0KPiArDQo+ICsJCWlmIChzY3NpX3BvaW50ZXItPnBoYXNlICYgc2Vs
ZWN0aW5nKSB7DQo+IAkJCVNFVFBPUlQoU1NUQVQxLCBTRUxUTyk7DQo+IAkJCVNFVFBPUlQoU0lN
T0RFMCwgRU5TRUxETyB8IChESVNDT05ORUNURURfU0MgPyBFTlNFTERJIDogMCkpOw0KPiAJCQlT
RVRQT1JUKFNJTU9ERTEsIEVOU0VMVElNTyk7DQo+IAkJfSBlbHNlIHsNCj4gLQkJCVNFVFBPUlQo
U0lNT0RFMCwgKENVUlJFTlRfU0MtPlNDcC5waGFzZSAmIHNwaW9yZHkpID8gRU5TUElPUkRZIDog
MCk7DQo+ICsJCQlTRVRQT1JUKFNJTU9ERTAsIChzY3NpX3BvaW50ZXItPnBoYXNlICYgc3Bpb3Jk
eSkgPyBFTlNQSU9SRFkgOiAwKTsNCj4gCQkJU0VUUE9SVChTSU1PREUxLCBFTlBIQVNFTUlTIHwg
RU5TQ1NJUlNUIHwgRU5TQ1NJUEVSUiB8IEVOQlVTRlJFRSk7DQo+IAkJfQ0KPiAJfSBlbHNlIGlm
KFNUQVRFPT1zZWxkaSkgew0KPiBAQCAtOTEwLDE2ICs5MjQsMTcgQEAgc3RhdGljIGludCBzZXR1
cF9leHBlY3RlZF9pbnRlcnJ1cHRzKHN0cnVjdCBTY3NpX0hvc3QgKnNocG50KQ0KPiBzdGF0aWMg
aW50IGFoYTE1MnhfaW50ZXJuYWxfcXVldWUoc3RydWN0IHNjc2lfY21uZCAqU0NwbnQsDQo+IAkJ
CQkgIHN0cnVjdCBjb21wbGV0aW9uICpjb21wbGV0ZSwgaW50IHBoYXNlKQ0KPiB7DQo+ICsJc3Ry
dWN0IHNjc2lfcG9pbnRlciAqc2NzaV9wb2ludGVyID0gYWhhMTUyeF9zY3NpX3BvaW50ZXIoU0Nw
bnQpOw0KPiAJc3RydWN0IFNjc2lfSG9zdCAqc2hwbnQgPSBTQ3BudC0+ZGV2aWNlLT5ob3N0Ow0K
PiAJdW5zaWduZWQgbG9uZyBmbGFnczsNCj4gDQo+IC0JU0NwbnQtPlNDcC5waGFzZQk9IG5vdF9p
c3N1ZWQgfCBwaGFzZTsNCj4gLQlTQ3BudC0+U0NwLlN0YXR1cwk9IDB4MTsgLyogSWxlZ2FsIHN0
YXR1cyBieSBTQ1NJIHN0YW5kYXJkICovDQo+IC0JU0NwbnQtPlNDcC5NZXNzYWdlCT0gMDsNCj4g
LQlTQ3BudC0+U0NwLmhhdmVfZGF0YV9pbgk9IDA7DQo+IC0JU0NwbnQtPlNDcC5zZW50X2NvbW1h
bmQJPSAwOw0KPiArCXNjc2lfcG9pbnRlci0+cGhhc2UJICAgPSBub3RfaXNzdWVkIHwgcGhhc2U7
DQo+ICsJc2NzaV9wb2ludGVyLT5TdGF0dXMJICAgPSAweDE7IC8qIElsZWdhbCBzdGF0dXMgYnkg
U0NTSSBzdGFuZGFyZCAqLw0KPiArCXNjc2lfcG9pbnRlci0+TWVzc2FnZQkgICA9IDA7DQo+ICsJ
c2NzaV9wb2ludGVyLT5oYXZlX2RhdGFfaW4gPSAwOw0KPiArCXNjc2lfcG9pbnRlci0+c2VudF9j
b21tYW5kID0gMDsNCj4gDQo+IC0JaWYoU0NwbnQtPlNDcC5waGFzZSAmIChyZXNldHRpbmd8Y2hl
Y2tfY29uZGl0aW9uKSkgew0KPiArCWlmIChzY3NpX3BvaW50ZXItPnBoYXNlICYgKHJlc2V0dGlu
ZyB8IGNoZWNrX2NvbmRpdGlvbikpIHsNCj4gCQlpZiAoIVNDcG50LT5ob3N0X3NjcmliYmxlIHx8
IFNDU0VNKFNDcG50KSB8fCBTQ05FWFQoU0NwbnQpKSB7DQo+IAkJCXNjbWRfcHJpbnRrKEtFUk5f
RVJSLCBTQ3BudCwgImNhbm5vdCByZXVzZSBjb21tYW5kXG4iKTsNCj4gCQkJcmV0dXJuIEZBSUxF
RDsNCj4gQEAgLTk0MiwxNSArOTU3LDE1IEBAIHN0YXRpYyBpbnQgYWhhMTUyeF9pbnRlcm5hbF9x
dWV1ZShzdHJ1Y3Qgc2NzaV9jbW5kICpTQ3BudCwNCj4gCSAgIFNDcC5waGFzZSAgICAgICAgICAg
IDogY3VycmVudCBzdGF0ZSBvZiB0aGUgY29tbWFuZCAqLw0KPiANCj4gCWlmICgocGhhc2UgJiBy
ZXNldHRpbmcpIHx8ICFzY3NpX3NnbGlzdChTQ3BudCkpIHsNCj4gLQkJU0NwbnQtPlNDcC5wdHIg
ICAgICAgICAgID0gTlVMTDsNCj4gLQkJU0NwbnQtPlNDcC50aGlzX3Jlc2lkdWFsID0gMDsNCj4g
KwkJc2NzaV9wb2ludGVyLT5wdHIgICAgICAgICAgID0gTlVMTDsNCj4gKwkJc2NzaV9wb2ludGVy
LT50aGlzX3Jlc2lkdWFsID0gMDsNCj4gCQlzY3NpX3NldF9yZXNpZChTQ3BudCwgMCk7DQo+IC0J
CVNDcG50LT5TQ3AuYnVmZmVyICAgICAgICAgICA9IE5VTEw7DQo+ICsJCXNjc2lfcG9pbnRlci0+
YnVmZmVyICAgICAgICA9IE5VTEw7DQo+IAl9IGVsc2Ugew0KPiAJCXNjc2lfc2V0X3Jlc2lkKFND
cG50LCBzY3NpX2J1ZmZsZW4oU0NwbnQpKTsNCj4gLQkJU0NwbnQtPlNDcC5idWZmZXIgICAgICAg
ICAgID0gc2NzaV9zZ2xpc3QoU0NwbnQpOw0KPiAtCQlTQ3BudC0+U0NwLnB0ciAgICAgICAgICAg
ICAgPSBTR19BRERSRVNTKFNDcG50LT5TQ3AuYnVmZmVyKTsNCj4gLQkJU0NwbnQtPlNDcC50aGlz
X3Jlc2lkdWFsICAgID0gU0NwbnQtPlNDcC5idWZmZXItPmxlbmd0aDsNCj4gKwkJc2NzaV9wb2lu
dGVyLT5idWZmZXIgICAgICAgID0gc2NzaV9zZ2xpc3QoU0NwbnQpOw0KPiArCQlzY3NpX3BvaW50
ZXItPnB0ciAgICAgICAgICAgPSBTR19BRERSRVNTKHNjc2lfcG9pbnRlci0+YnVmZmVyKTsNCj4g
KwkJc2NzaV9wb2ludGVyLT50aGlzX3Jlc2lkdWFsID0gc2NzaV9wb2ludGVyLT5idWZmZXItPmxl
bmd0aDsNCj4gCX0NCj4gDQo+IAlET19MT0NLKGZsYWdzKTsNCj4gQEAgLTEwMDAsNyArMTAxNSw3
IEBAIHN0YXRpYyB2b2lkIHJlc2V0X2RvbmUoc3RydWN0IHNjc2lfY21uZCAqU0NwbnQpDQo+IA0K
PiBzdGF0aWMgdm9pZCBhaGExNTJ4X3Njc2lfZG9uZShzdHJ1Y3Qgc2NzaV9jbW5kICpTQ3BudCkN
Cj4gew0KPiAtCWlmIChTQ3BudC0+U0NwLnBoYXNlICYgcmVzZXR0aW5nKQ0KPiArCWlmIChhaGEx
NTJ4X3Njc2lfcG9pbnRlcihTQ3BudCktPnBoYXNlICYgcmVzZXR0aW5nKQ0KPiAJCXJlc2V0X2Rv
bmUoU0NwbnQpOw0KPiAJZWxzZQ0KPiAJCXNjc2lfZG9uZShTQ3BudCk7DQo+IEBAIC0xMDg2LDcg
KzExMDEsNyBAQCBzdGF0aWMgaW50IGFoYTE1MnhfZGV2aWNlX3Jlc2V0KHN0cnVjdCBzY3NpX2Nt
bmQgKiBTQ3BudCkNCj4gDQo+IAlET19MT0NLKGZsYWdzKTsNCj4gDQo+IC0JaWYoU0NwbnQtPlND
cC5waGFzZSAmIHJlc2V0dGVkKSB7DQo+ICsJaWYgKGFoYTE1Mnhfc2NzaV9wb2ludGVyKFNDcG50
KS0+cGhhc2UgJiByZXNldHRlZCkgew0KPiAJCUhPU1REQVRBKHNocG50KS0+Y29tbWFuZHMtLTsN
Cj4gCQlpZiAoIUhPU1REQVRBKHNocG50KS0+Y29tbWFuZHMpDQo+IAkJCVNFVFBPUlQoUE9SVEEs
IDApOw0KPiBAQCAtMTM4MCwyOCArMTM5NSwzMSBAQCBzdGF0aWMgdm9pZCBidXNmcmVlX3J1bihz
dHJ1Y3QgU2NzaV9Ib3N0ICpzaHBudCkNCj4gCVNFVFBPUlQoU1NUQVQxLCBDTFJCVVNGUkVFKTsN
Cj4gDQo+IAlpZihDVVJSRU5UX1NDKSB7DQo+ICsJCXN0cnVjdCBzY3NpX3BvaW50ZXIgKnNjc2lf
cG9pbnRlciA9DQo+ICsJCQlhaGExNTJ4X3Njc2lfcG9pbnRlcihDVVJSRU5UX1NDKTsNCj4gKw0K
PiAjaWYgZGVmaW5lZChBSEExNTJYX1NUQVQpDQo+IAkJYWN0aW9uKys7DQo+ICNlbmRpZg0KPiAt
CQlDVVJSRU5UX1NDLT5TQ3AucGhhc2UgJj0gfnN5bmNuZWc7DQo+ICsJCXNjc2lfcG9pbnRlci0+
cGhhc2UgJj0gfnN5bmNuZWc7DQo+IA0KPiAtCQlpZihDVVJSRU5UX1NDLT5TQ3AucGhhc2UgJiBj
b21wbGV0ZWQpIHsNCj4gKwkJaWYgKHNjc2lfcG9pbnRlci0+cGhhc2UgJiBjb21wbGV0ZWQpIHsN
Cj4gCQkJLyogdGFyZ2V0IHNlbnQgQ09NTUFORCBDT01QTEVURSAqLw0KPiAtCQkJZG9uZShzaHBu
dCwgQ1VSUkVOVF9TQy0+U0NwLlN0YXR1cywgRElEX09LKTsNCj4gKwkJCWRvbmUoc2hwbnQsIHNj
c2lfcG9pbnRlci0+U3RhdHVzLCBESURfT0spOw0KPiANCj4gLQkJfSBlbHNlIGlmKENVUlJFTlRf
U0MtPlNDcC5waGFzZSAmIGFib3J0ZWQpIHsNCj4gLQkJCWRvbmUoc2hwbnQsIENVUlJFTlRfU0Mt
PlNDcC5TdGF0dXMsIERJRF9BQk9SVCk7DQo+ICsJCX0gZWxzZSBpZiAoc2NzaV9wb2ludGVyLT5w
aGFzZSAmIGFib3J0ZWQpIHsNCj4gKwkJCWRvbmUoc2hwbnQsIHNjc2lfcG9pbnRlci0+U3RhdHVz
LCBESURfQUJPUlQpOw0KPiANCj4gLQkJfSBlbHNlIGlmKENVUlJFTlRfU0MtPlNDcC5waGFzZSAm
IHJlc2V0dGVkKSB7DQo+IC0JCQlkb25lKHNocG50LCBDVVJSRU5UX1NDLT5TQ3AuU3RhdHVzLCBE
SURfUkVTRVQpOw0KPiArCQl9IGVsc2UgaWYgKHNjc2lfcG9pbnRlci0+cGhhc2UgJiByZXNldHRl
ZCkgew0KPiArCQkJZG9uZShzaHBudCwgc2NzaV9wb2ludGVyLT5TdGF0dXMsIERJRF9SRVNFVCk7
DQo+IA0KPiAtCQl9IGVsc2UgaWYoQ1VSUkVOVF9TQy0+U0NwLnBoYXNlICYgZGlzY29ubmVjdGVk
KSB7DQo+ICsJCX0gZWxzZSBpZiAoc2NzaV9wb2ludGVyLT5waGFzZSAmIGRpc2Nvbm5lY3RlZCkg
ew0KPiAJCQkvKiB0YXJnZXQgc2VudCBESVNDT05ORUNUICovDQo+ICNpZiBkZWZpbmVkKEFIQTE1
MlhfU1RBVCkNCj4gCQkJSE9TVERBVEEoc2hwbnQpLT5kaXNjb25uZWN0aW9ucysrOw0KPiAjZW5k
aWYNCj4gCQkJYXBwZW5kX1NDKCZESVNDT05ORUNURURfU0MsIENVUlJFTlRfU0MpOw0KPiAtCQkJ
Q1VSUkVOVF9TQy0+U0NwLnBoYXNlIHw9IDEgPDwgMTY7DQo+ICsJCQlzY3NpX3BvaW50ZXItPnBo
YXNlIHw9IDEgPDwgMTY7DQo+IAkJCUNVUlJFTlRfU0MgPSBOVUxMOw0KPiANCj4gCQl9IGVsc2Ug
ew0KPiBAQCAtMTQyMCwyMyArMTQzOCwyNCBAQCBzdGF0aWMgdm9pZCBidXNmcmVlX3J1bihzdHJ1
Y3QgU2NzaV9Ib3N0ICpzaHBudCkNCj4gCQlhY3Rpb24rKzsNCj4gI2VuZGlmDQo+IA0KPiAtCQlp
ZihET05FX1NDLT5TQ3AucGhhc2UgJiBjaGVja19jb25kaXRpb24pIHsNCj4gKwkJaWYgKGFoYTE1
Mnhfc2NzaV9wb2ludGVyKERPTkVfU0MpLT5waGFzZSAmIGNoZWNrX2NvbmRpdGlvbikgew0KPiAJ
CQlzdHJ1Y3Qgc2NzaV9jbW5kICpjbWQgPSBIT1NUREFUQShzaHBudCktPmRvbmVfU0M7DQo+IAkJ
CXN0cnVjdCBhaGExNTJ4X3NjZGF0YSAqc2MgPSBTQ0RBVEEoY21kKTsNCj4gDQo+IAkJCXNjc2lf
ZWhfcmVzdG9yZV9jbW5kKGNtZCwgJnNjLT5zZXMpOw0KPiANCj4gLQkJCWNtZC0+U0NwLlN0YXR1
cyA9IFNBTV9TVEFUX0NIRUNLX0NPTkRJVElPTjsNCj4gKwkJCWFoYTE1Mnhfc2NzaV9wb2ludGVy
KGNtZCktPlN0YXR1cyA9IFNBTV9TVEFUX0NIRUNLX0NPTkRJVElPTjsNCj4gDQo+IAkJCUhPU1RE
QVRBKHNocG50KS0+Y29tbWFuZHMtLTsNCj4gCQkJaWYgKCFIT1NUREFUQShzaHBudCktPmNvbW1h
bmRzKQ0KPiAJCQkJU0VUUE9SVChQT1JUQSwgMCk7CS8qIHR1cm4gbGVkIG9mZiAqLw0KPiAtCQl9
IGVsc2UgaWYoRE9ORV9TQy0+U0NwLlN0YXR1cz09U0FNX1NUQVRfQ0hFQ0tfQ09ORElUSU9OKSB7
DQo+ICsJCX0gZWxzZSBpZiAoYWhhMTUyeF9zY3NpX3BvaW50ZXIoRE9ORV9TQyktPlN0YXR1cyA9
PQ0KPiArCQkJICAgU0FNX1NUQVRfQ0hFQ0tfQ09ORElUSU9OKSB7DQo+ICNpZiBkZWZpbmVkKEFI
QTE1MlhfU1RBVCkNCj4gCQkJSE9TVERBVEEoc2hwbnQpLT5idXNmcmVlX3dpdGhfY2hlY2tfY29u
ZGl0aW9uKys7DQo+ICNlbmRpZg0KPiANCj4gLQkJCWlmKCEoRE9ORV9TQy0+U0NwLnBoYXNlICYg
bm90X2lzc3VlZCkpIHsNCj4gKwkJCWlmKCEoYWhhMTUyeF9zY3NpX3BvaW50ZXIoRE9ORV9TQykt
PnBoYXNlICYgbm90X2lzc3VlZCkpIHsNCj4gCQkJCXN0cnVjdCBhaGExNTJ4X3NjZGF0YSAqc2M7
DQo+IAkJCQlzdHJ1Y3Qgc2NzaV9jbW5kICpwdHIgPSBET05FX1NDOw0KPiAJCQkJRE9ORV9TQz1O
VUxMOw0KPiBAQCAtMTQ2MSw3ICsxNDgwLDcgQEAgc3RhdGljIHZvaWQgYnVzZnJlZV9ydW4oc3Ry
dWN0IFNjc2lfSG9zdCAqc2hwbnQpDQo+IAkJCWlmICghSE9TVERBVEEoc2hwbnQpLT5jb21tYW5k
cykNCj4gCQkJCVNFVFBPUlQoUE9SVEEsIDApOwkvKiB0dXJuIGxlZCBvZmYgKi8NCj4gDQo+IC0J
CQlpZiAoIShwdHItPlNDcC5waGFzZSAmIHJlc2V0dGluZykpIHsNCj4gKwkJCWlmICghKGFoYTE1
Mnhfc2NzaV9wb2ludGVyKHB0ciktPnBoYXNlICYgcmVzZXR0aW5nKSkgew0KPiAJCQkJa2ZyZWUo
cHRyLT5ob3N0X3NjcmliYmxlKTsNCj4gCQkJCXB0ci0+aG9zdF9zY3JpYmJsZT1OVUxMOw0KPiAJ
CQl9DQo+IEBAIC0xNDg0LDEwICsxNTAzLDEzIEBAIHN0YXRpYyB2b2lkIGJ1c2ZyZWVfcnVuKHN0
cnVjdCBTY3NpX0hvc3QgKnNocG50KQ0KPiAJRE9fVU5MT0NLKGZsYWdzKTsNCj4gDQo+IAlpZihD
VVJSRU5UX1NDKSB7DQo+ICsJCXN0cnVjdCBzY3NpX3BvaW50ZXIgKnNjc2lfcG9pbnRlciA9DQo+
ICsJCQlhaGExNTJ4X3Njc2lfcG9pbnRlcihDVVJSRU5UX1NDKTsNCj4gKw0KPiAjaWYgZGVmaW5l
ZChBSEExNTJYX1NUQVQpDQo+IAkJYWN0aW9uKys7DQo+ICNlbmRpZg0KPiAtCQlDVVJSRU5UX1ND
LT5TQ3AucGhhc2UgfD0gc2VsZWN0aW5nOw0KPiArCQlzY3NpX3BvaW50ZXItPnBoYXNlIHw9IHNl
bGVjdGluZzsNCj4gDQo+IAkJLyogY2xlYXIgc2VsZWN0aW9uIHRpbWVvdXQgKi8NCj4gCQlTRVRQ
T1JUKFNTVEFUMSwgU0VMVE8pOw0KPiBAQCAtMTUxNSwxMSArMTUzNywxMyBAQCBzdGF0aWMgdm9p
ZCBidXNmcmVlX3J1bihzdHJ1Y3QgU2NzaV9Ib3N0ICpzaHBudCkNCj4gICovDQo+IHN0YXRpYyB2
b2lkIHNlbGRvX3J1bihzdHJ1Y3QgU2NzaV9Ib3N0ICpzaHBudCkNCj4gew0KPiArCXN0cnVjdCBz
Y3NpX3BvaW50ZXIgKnNjc2lfcG9pbnRlciA9IGFoYTE1Mnhfc2NzaV9wb2ludGVyKENVUlJFTlRf
U0MpOw0KPiArDQo+IAlTRVRQT1JUKFNDU0lTSUcsIDApOw0KPiAJU0VUUE9SVChTU1RBVDEsIENM
UkJVU0ZSRUUpOw0KPiAJU0VUUE9SVChTU1RBVDEsIENMUlBIQVNFQ0hHKTsNCj4gDQo+IC0JQ1VS
UkVOVF9TQy0+U0NwLnBoYXNlICY9IH4oc2VsZWN0aW5nfG5vdF9pc3N1ZWQpOw0KPiArCXNjc2lf
cG9pbnRlci0+cGhhc2UgJj0gfihzZWxlY3RpbmcgfCBub3RfaXNzdWVkKTsNCj4gDQo+IAlTRVRQ
T1JUKFNDU0lTRVEsIDApOw0KPiANCj4gQEAgLTE1MzQsMTIgKzE1NTgsMTIgQEAgc3RhdGljIHZv
aWQgc2VsZG9fcnVuKHN0cnVjdCBTY3NpX0hvc3QgKnNocG50KQ0KPiANCj4gCUFERE1TR08oSURF
TlRJRlkoUkVDT05ORUNULCBDVVJSRU5UX1NDLT5kZXZpY2UtPmx1bikpOw0KPiANCj4gLQlpZiAo
Q1VSUkVOVF9TQy0+U0NwLnBoYXNlICYgYWJvcnRpbmcpIHsNCj4gKwlpZiAoc2NzaV9wb2ludGVy
LT5waGFzZSAmIGFib3J0aW5nKSB7DQo+IAkJQURETVNHTyhBQk9SVCk7DQo+IC0JfSBlbHNlIGlm
IChDVVJSRU5UX1NDLT5TQ3AucGhhc2UgJiByZXNldHRpbmcpIHsNCj4gKwl9IGVsc2UgaWYgKHNj
c2lfcG9pbnRlci0+cGhhc2UgJiByZXNldHRpbmcpIHsNCj4gCQlBRERNU0dPKEJVU19ERVZJQ0Vf
UkVTRVQpOw0KPiAJfSBlbHNlIGlmIChTWU5DTkVHPT0wICYmIFNZTkNIUk9OT1VTKSB7DQo+IC0J
CUNVUlJFTlRfU0MtPlNDcC5waGFzZSB8PSBzeW5jbmVnOw0KPiArCQlzY3NpX3BvaW50ZXItPnBo
YXNlIHw9IHN5bmNuZWc7DQo+IAkJTVNHT0xFTiArPSBzcGlfcG9wdWxhdGVfc3luY19tc2coJk1T
R08oTVNHT0xFTiksIDUwLCA4KTsNCj4gCQlTWU5DTkVHPTE7CQkvKiBuZWdvdGlhdGlvbiBpbiBw
cm9ncmVzcyAqLw0KPiAJfQ0KPiBAQCAtMTU1NCwxNSArMTU3OCwxNyBAQCBzdGF0aWMgdm9pZCBz
ZWxkb19ydW4oc3RydWN0IFNjc2lfSG9zdCAqc2hwbnQpDQo+ICAqLw0KPiBzdGF0aWMgdm9pZCBz
ZWx0b19ydW4oc3RydWN0IFNjc2lfSG9zdCAqc2hwbnQpDQo+IHsNCj4gKwlzdHJ1Y3Qgc2NzaV9w
b2ludGVyICpzY3NpX3BvaW50ZXIgPSBhaGExNTJ4X3Njc2lfcG9pbnRlcihDVVJSRU5UX1NDKTsN
Cj4gKw0KPiAJU0VUUE9SVChTQ1NJU0VRLCAwKTsNCj4gCVNFVFBPUlQoU1NUQVQxLCBDTFJTRUxU
SU1PKTsNCj4gDQo+IAlpZiAoIUNVUlJFTlRfU0MpDQo+IAkJcmV0dXJuOw0KPiANCj4gLQlDVVJS
RU5UX1NDLT5TQ3AucGhhc2UgJj0gfnNlbGVjdGluZzsNCj4gKwlzY3NpX3BvaW50ZXItPnBoYXNl
ICY9IH5zZWxlY3Rpbmc7DQo+IA0KPiAtCWlmIChDVVJSRU5UX1NDLT5TQ3AucGhhc2UgJiBhYm9y
dGVkKQ0KPiArCWlmIChzY3NpX3BvaW50ZXItPnBoYXNlICYgYWJvcnRlZCkNCj4gCQlkb25lKHNo
cG50LCBTQU1fU1RBVF9HT09ELCBESURfQUJPUlQpOw0KPiAJZWxzZSBpZiAoVEVTVExPKFNTVEFU
MCwgU0VMSU5HTykpDQo+IAkJZG9uZShzaHBudCwgU0FNX1NUQVRfR09PRCwgRElEX0JVU19CVVNZ
KTsNCj4gQEAgLTE1OTAsNyArMTYxNiwxMCBAQCBzdGF0aWMgdm9pZCBzZWxkaV9ydW4oc3RydWN0
IFNjc2lfSG9zdCAqc2hwbnQpDQo+IAlTRVRQT1JUKFNTVEFUMSwgQ0xSUEhBU0VDSEcpOw0KPiAN
Cj4gCWlmKENVUlJFTlRfU0MpIHsNCj4gLQkJaWYoIShDVVJSRU5UX1NDLT5TQ3AucGhhc2UgJiBu
b3RfaXNzdWVkKSkNCj4gKwkJc3RydWN0IHNjc2lfcG9pbnRlciAqc2NzaV9wb2ludGVyID0NCj4g
KwkJCWFoYTE1Mnhfc2NzaV9wb2ludGVyKENVUlJFTlRfU0MpOw0KPiArDQo+ICsJCWlmICghKHNj
c2lfcG9pbnRlci0+cGhhc2UgJiBub3RfaXNzdWVkKSkNCj4gCQkJc2NtZF9wcmludGsoS0VSTl9F
UlIsIENVUlJFTlRfU0MsDQo+IAkJCQkgICAgImNvbW1hbmQgc2hvdWxkIG5vdCBoYXZlIGJlZW4g
aXNzdWVkIHlldFxuIik7DQo+IA0KPiBAQCAtMTY0Nyw2ICsxNjc2LDcgQEAgc3RhdGljIHZvaWQg
c2VsZGlfcnVuKHN0cnVjdCBTY3NpX0hvc3QgKnNocG50KQ0KPiBzdGF0aWMgdm9pZCBtc2dpX3J1
bihzdHJ1Y3QgU2NzaV9Ib3N0ICpzaHBudCkNCj4gew0KPiAJZm9yKDs7KSB7DQo+ICsJCXN0cnVj
dCBzY3NpX3BvaW50ZXIgKnNjc2lfcG9pbnRlcjsNCj4gCQlpbnQgc3N0YXQxID0gR0VUUE9SVChT
U1RBVDEpOw0KPiANCj4gCQlpZihzc3RhdDEgJiAoUEhBU0VDSEd8UEhBU0VNSVN8QlVTRlJFRSkg
fHwgIShzc3RhdDEgJiBSRVFJTklUKSkNCj4gQEAgLTE2ODQsOCArMTcxNCw5IEBAIHN0YXRpYyB2
b2lkIG1zZ2lfcnVuKHN0cnVjdCBTY3NpX0hvc3QgKnNocG50KQ0KPiAJCQkJY29udGludWU7DQo+
IAkJCX0NCj4gDQo+IC0JCQlDVVJSRU5UX1NDLT5TQ3AuTWVzc2FnZSA9IE1TR0koMCk7DQo+IC0J
CQlDVVJSRU5UX1NDLT5TQ3AucGhhc2UgJj0gfmRpc2Nvbm5lY3RlZDsNCj4gKwkJCXNjc2lfcG9p
bnRlciA9IGFoYTE1Mnhfc2NzaV9wb2ludGVyKENVUlJFTlRfU0MpOw0KPiArCQkJc2NzaV9wb2lu
dGVyLT5NZXNzYWdlID0gTVNHSSgwKTsNCj4gKwkJCXNjc2lfcG9pbnRlci0+cGhhc2UgJj0gfmRp
c2Nvbm5lY3RlZDsNCj4gDQo+IAkJCU1TR0lMRU49MDsNCj4gDQo+IEBAIC0xNjkzLDcgKzE3MjQs
OCBAQCBzdGF0aWMgdm9pZCBtc2dpX3J1bihzdHJ1Y3QgU2NzaV9Ib3N0ICpzaHBudCkNCj4gCQkJ
Y29udGludWU7DQo+IAkJfQ0KPiANCj4gLQkJQ1VSUkVOVF9TQy0+U0NwLk1lc3NhZ2UgPSBNU0dJ
KDApOw0KPiArCQlzY3NpX3BvaW50ZXIgPSBhaGExNTJ4X3Njc2lfcG9pbnRlcihDVVJSRU5UX1ND
KTsNCj4gKwkJc2NzaV9wb2ludGVyLT5NZXNzYWdlID0gTVNHSSgwKTsNCj4gDQo+IAkJc3dpdGNo
IChNU0dJKDApKSB7DQo+IAkJY2FzZSBESVNDT05ORUNUOg0KPiBAQCAtMTcwMSwxMSArMTczMywx
MSBAQCBzdGF0aWMgdm9pZCBtc2dpX3J1bihzdHJ1Y3QgU2NzaV9Ib3N0ICpzaHBudCkNCj4gCQkJ
CXNjbWRfcHJpbnRrKEtFUk5fV0FSTklORywgQ1VSUkVOVF9TQywNCj4gCQkJCQkgICAgInRhcmdl
dCB3YXMgbm90IGFsbG93ZWQgdG8gZGlzY29ubmVjdFxuIik7DQo+IA0KPiAtCQkJQ1VSUkVOVF9T
Qy0+U0NwLnBoYXNlIHw9IGRpc2Nvbm5lY3RlZDsNCj4gKwkJCXNjc2lfcG9pbnRlci0+cGhhc2Ug
fD0gZGlzY29ubmVjdGVkOw0KPiAJCQlicmVhazsNCj4gDQo+IAkJY2FzZSBDT01NQU5EX0NPTVBM
RVRFOg0KPiAtCQkJQ1VSUkVOVF9TQy0+U0NwLnBoYXNlIHw9IGNvbXBsZXRlZDsNCj4gKwkJCXNj
c2lfcG9pbnRlci0+cGhhc2UgfD0gY29tcGxldGVkOw0KPiAJCQlicmVhazsNCj4gDQo+IAkJY2Fz
ZSBNRVNTQUdFX1JFSkVDVDoNCj4gQEAgLTE4MzUsOCArMTg2NywxMSBAQCBzdGF0aWMgdm9pZCBt
c2dpX2VuZChzdHJ1Y3QgU2NzaV9Ib3N0ICpzaHBudCkNCj4gICovDQo+IHN0YXRpYyB2b2lkIG1z
Z29faW5pdChzdHJ1Y3QgU2NzaV9Ib3N0ICpzaHBudCkNCj4gew0KPiArCXN0cnVjdCBzY3NpX3Bv
aW50ZXIgKnNjc2lfcG9pbnRlciA9IGFoYTE1Mnhfc2NzaV9wb2ludGVyKENVUlJFTlRfU0MpOw0K
PiArDQo+IAlpZihNU0dPTEVOPT0wKSB7DQo+IC0JCWlmKChDVVJSRU5UX1NDLT5TQ3AucGhhc2Ug
JiBzeW5jbmVnKSAmJiBTWU5DTkVHPT0yICYmIFNZTkNSQVRFPT0wKSB7DQo+ICsJCWlmICgoc2Nz
aV9wb2ludGVyLT5waGFzZSAmIHN5bmNuZWcpICYmIFNZTkNORUc9PTIgJiYNCj4gKwkJICAgIFNZ
TkNSQVRFPT0wKSB7DQo+IAkJCUFERE1TR08oSURFTlRJRlkoUkVDT05ORUNULCBDVVJSRU5UX1ND
LT5kZXZpY2UtPmx1bikpOw0KPiAJCX0gZWxzZSB7DQo+IAkJCXNjbWRfcHJpbnRrKEtFUk5fSU5G
TywgQ1VSUkVOVF9TQywNCj4gQEAgLTE4NTMsNiArMTg4OCw4IEBAIHN0YXRpYyB2b2lkIG1zZ29f
aW5pdChzdHJ1Y3QgU2NzaV9Ib3N0ICpzaHBudCkNCj4gICovDQo+IHN0YXRpYyB2b2lkIG1zZ29f
cnVuKHN0cnVjdCBTY3NpX0hvc3QgKnNocG50KQ0KPiB7DQo+ICsJc3RydWN0IHNjc2lfcG9pbnRl
ciAqc2NzaV9wb2ludGVyID0gYWhhMTUyeF9zY3NpX3BvaW50ZXIoQ1VSUkVOVF9TQyk7DQo+ICsN
Cj4gCXdoaWxlKE1TR09fSTxNU0dPTEVOKSB7DQo+IAkJaWYgKFRFU1RMTyhTU1RBVDAsIFNQSU9S
RFkpKQ0KPiAJCQlyZXR1cm47DQo+IEBAIC0xODY0LDEzICsxOTAxLDEzIEBAIHN0YXRpYyB2b2lk
IG1zZ29fcnVuKHN0cnVjdCBTY3NpX0hvc3QgKnNocG50KQ0KPiANCj4gDQo+IAkJaWYgKE1TR08o
TVNHT19JKSAmIElERU5USUZZX0JBU0UpDQo+IC0JCQlDVVJSRU5UX1NDLT5TQ3AucGhhc2UgfD0g
aWRlbnRpZmllZDsNCj4gKwkJCXNjc2lfcG9pbnRlci0+cGhhc2UgfD0gaWRlbnRpZmllZDsNCj4g
DQo+IAkJaWYgKE1TR08oTVNHT19JKT09QUJPUlQpDQo+IC0JCQlDVVJSRU5UX1NDLT5TQ3AucGhh
c2UgfD0gYWJvcnRlZDsNCj4gKwkJCXNjc2lfcG9pbnRlci0+cGhhc2UgfD0gYWJvcnRlZDsNCj4g
DQo+IAkJaWYgKE1TR08oTVNHT19JKT09QlVTX0RFVklDRV9SRVNFVCkNCj4gLQkJCUNVUlJFTlRf
U0MtPlNDcC5waGFzZSB8PSByZXNldHRlZDsNCj4gKwkJCXNjc2lfcG9pbnRlci0+cGhhc2UgfD0g
cmVzZXR0ZWQ7DQo+IA0KPiAJCVNFVFBPUlQoU0NTSURBVCwgTVNHTyhNU0dPX0krKykpOw0KPiAJ
fQ0KPiBAQCAtMTg5OSw3ICsxOTM2LDcgQEAgc3RhdGljIHZvaWQgbXNnb19lbmQoc3RydWN0IFNj
c2lfSG9zdCAqc2hwbnQpDQo+ICAqLw0KPiBzdGF0aWMgdm9pZCBjbWRfaW5pdChzdHJ1Y3QgU2Nz
aV9Ib3N0ICpzaHBudCkNCj4gew0KPiAtCWlmIChDVVJSRU5UX1NDLT5TQ3Auc2VudF9jb21tYW5k
KSB7DQo+ICsJaWYgKGFoYTE1Mnhfc2NzaV9wb2ludGVyKENVUlJFTlRfU0MpLT5zZW50X2NvbW1h
bmQpIHsNCj4gCQlzY21kX3ByaW50ayhLRVJOX0VSUiwgQ1VSUkVOVF9TQywNCj4gCQkJICAgICJj
b21tYW5kIGFscmVhZHkgc2VudFxuIik7DQo+IAkJZG9uZShzaHBudCwgU0FNX1NUQVRfR09PRCwg
RElEX0VSUk9SKTsNCj4gQEAgLTE5MzAsNyArMTk2Nyw3IEBAIHN0YXRpYyB2b2lkIGNtZF9lbmQo
c3RydWN0IFNjc2lfSG9zdCAqc2hwbnQpDQo+IAkJCSAgICAiY29tbWFuZCBzZW50IGluY29tcGxl
dGVseSAoJWQvJWQpXG4iLA0KPiAJCQkgICAgQ01EX0ksIENVUlJFTlRfU0MtPmNtZF9sZW4pOw0K
PiAJZWxzZQ0KPiAtCQlDVVJSRU5UX1NDLT5TQ3Auc2VudF9jb21tYW5kKys7DQo+ICsJCWFoYTE1
Mnhfc2NzaV9wb2ludGVyKENVUlJFTlRfU0MpLT5zZW50X2NvbW1hbmQrKzsNCj4gfQ0KPiANCj4g
LyoNCj4gQEAgLTE5NDIsNyArMTk3OSw3IEBAIHN0YXRpYyB2b2lkIHN0YXR1c19ydW4oc3RydWN0
IFNjc2lfSG9zdCAqc2hwbnQpDQo+IAlpZiAoVEVTVExPKFNTVEFUMCwgU1BJT1JEWSkpDQo+IAkJ
cmV0dXJuOw0KPiANCj4gLQlDVVJSRU5UX1NDLT5TQ3AuU3RhdHVzID0gR0VUUE9SVChTQ1NJREFU
KTsNCj4gKwlhaGExNTJ4X3Njc2lfcG9pbnRlcihDVVJSRU5UX1NDKS0+U3RhdHVzID0gR0VUUE9S
VChTQ1NJREFUKTsNCj4gDQo+IH0NCj4gDQo+IEBAIC0xOTY2LDYgKzIwMDMsNyBAQCBzdGF0aWMg
dm9pZCBkYXRhaV9pbml0KHN0cnVjdCBTY3NpX0hvc3QgKnNocG50KQ0KPiANCj4gc3RhdGljIHZv
aWQgZGF0YWlfcnVuKHN0cnVjdCBTY3NpX0hvc3QgKnNocG50KQ0KPiB7DQo+ICsJc3RydWN0IHNj
c2lfcG9pbnRlciAqc2NzaV9wb2ludGVyOw0KPiAJdW5zaWduZWQgbG9uZyB0aGVfdGltZTsNCj4g
CWludCBmaWZvZGF0YSwgZGF0YV9jb3VudDsNCj4gDQo+IEBAIC0yMDAzLDM1ICsyMDQxLDM2IEBA
IHN0YXRpYyB2b2lkIGRhdGFpX3J1bihzdHJ1Y3QgU2NzaV9Ib3N0ICpzaHBudCkNCj4gCQkJZmlm
b2RhdGEgPSBHRVRQT1JUKEZJRk9TVEFUKTsNCj4gCQl9DQo+IA0KPiAtCQlpZihDVVJSRU5UX1ND
LT5TQ3AudGhpc19yZXNpZHVhbD4wKSB7DQo+IC0JCQl3aGlsZShmaWZvZGF0YT4wICYmIENVUlJF
TlRfU0MtPlNDcC50aGlzX3Jlc2lkdWFsPjApIHsNCj4gLQkJCQlkYXRhX2NvdW50ID0gZmlmb2Rh
dGEgPiBDVVJSRU5UX1NDLT5TQ3AudGhpc19yZXNpZHVhbCA/DQo+IC0JCQkJCQlDVVJSRU5UX1ND
LT5TQ3AudGhpc19yZXNpZHVhbCA6DQo+ICsJCXNjc2lfcG9pbnRlciA9IGFoYTE1Mnhfc2NzaV9w
b2ludGVyKENVUlJFTlRfU0MpOw0KPiArCQlpZiAoc2NzaV9wb2ludGVyLT50aGlzX3Jlc2lkdWFs
ID4gMCkgew0KPiArCQkJd2hpbGUgKGZpZm9kYXRhID4gMCAmJiBzY3NpX3BvaW50ZXItPnRoaXNf
cmVzaWR1YWwgPiAwKSB7DQo+ICsJCQkJZGF0YV9jb3VudCA9IGZpZm9kYXRhID4gc2NzaV9wb2lu
dGVyLT50aGlzX3Jlc2lkdWFsID8NCj4gKwkJCQkJCXNjc2lfcG9pbnRlci0+dGhpc19yZXNpZHVh
bCA6DQo+IAkJCQkJCWZpZm9kYXRhOw0KPiAJCQkJZmlmb2RhdGEgLT0gZGF0YV9jb3VudDsNCj4g
DQo+IAkJCQlpZiAoZGF0YV9jb3VudCAmIDEpIHsNCj4gCQkJCQlTRVRQT1JUKERNQUNOVFJMMCwg
RU5ETUF8XzhCSVQpOw0KPiAtCQkJCQkqQ1VSUkVOVF9TQy0+U0NwLnB0cisrID0gR0VUUE9SVChE
QVRBUE9SVCk7DQo+IC0JCQkJCUNVUlJFTlRfU0MtPlNDcC50aGlzX3Jlc2lkdWFsLS07DQo+ICsJ
CQkJCSpzY3NpX3BvaW50ZXItPnB0cisrID0gR0VUUE9SVChEQVRBUE9SVCk7DQo+ICsJCQkJCXNj
c2lfcG9pbnRlci0+dGhpc19yZXNpZHVhbC0tOw0KPiAJCQkJCURBVEFfTEVOKys7DQo+IAkJCQkJ
U0VUUE9SVChETUFDTlRSTDAsIEVORE1BKTsNCj4gCQkJCX0NCj4gDQo+IAkJCQlpZiAoZGF0YV9j
b3VudCA+IDEpIHsNCj4gCQkJCQlkYXRhX2NvdW50ID4+PSAxOw0KPiAtCQkJCQlpbnN3KERBVEFQ
T1JULCBDVVJSRU5UX1NDLT5TQ3AucHRyLCBkYXRhX2NvdW50KTsNCj4gLQkJCQkJQ1VSUkVOVF9T
Qy0+U0NwLnB0ciArPSAyICogZGF0YV9jb3VudDsNCj4gLQkJCQkJQ1VSUkVOVF9TQy0+U0NwLnRo
aXNfcmVzaWR1YWwgLT0gMiAqIGRhdGFfY291bnQ7DQo+ICsJCQkJCWluc3coREFUQVBPUlQsIHNj
c2lfcG9pbnRlci0+cHRyLCBkYXRhX2NvdW50KTsNCj4gKwkJCQkJc2NzaV9wb2ludGVyLT5wdHIg
Kz0gMiAqIGRhdGFfY291bnQ7DQo+ICsJCQkJCXNjc2lfcG9pbnRlci0+dGhpc19yZXNpZHVhbCAt
PSAyICogZGF0YV9jb3VudDsNCj4gCQkJCQlEQVRBX0xFTiArPSAyICogZGF0YV9jb3VudDsNCj4g
CQkJCX0NCj4gDQo+IC0JCQkJaWYgKENVUlJFTlRfU0MtPlNDcC50aGlzX3Jlc2lkdWFsID09IDAg
JiYNCj4gLQkJCQkgICAgIXNnX2lzX2xhc3QoQ1VSUkVOVF9TQy0+U0NwLmJ1ZmZlcikpIHsNCj4g
KwkJCQlpZiAoc2NzaV9wb2ludGVyLT50aGlzX3Jlc2lkdWFsID09IDAgJiYNCj4gKwkJCQkgICAg
IXNnX2lzX2xhc3Qoc2NzaV9wb2ludGVyLT5idWZmZXIpKSB7DQo+IAkJCQkJLyogYWR2YW5jZSB0
byBuZXh0IGJ1ZmZlciAqLw0KPiAtCQkJCQlDVVJSRU5UX1NDLT5TQ3AuYnVmZmVyID0gc2dfbmV4
dChDVVJSRU5UX1NDLT5TQ3AuYnVmZmVyKTsNCj4gLQkJCQkJQ1VSUkVOVF9TQy0+U0NwLnB0ciAg
ICAgICAgICAgPSBTR19BRERSRVNTKENVUlJFTlRfU0MtPlNDcC5idWZmZXIpOw0KPiAtCQkJCQlD
VVJSRU5UX1NDLT5TQ3AudGhpc19yZXNpZHVhbCA9IENVUlJFTlRfU0MtPlNDcC5idWZmZXItPmxl
bmd0aDsNCj4gKwkJCQkJc2NzaV9wb2ludGVyLT5idWZmZXIgPSBzZ19uZXh0KHNjc2lfcG9pbnRl
ci0+YnVmZmVyKTsNCj4gKwkJCQkJc2NzaV9wb2ludGVyLT5wdHIgICAgICAgICAgID0gU0dfQURE
UkVTUyhzY3NpX3BvaW50ZXItPmJ1ZmZlcik7DQo+ICsJCQkJCXNjc2lfcG9pbnRlci0+dGhpc19y
ZXNpZHVhbCA9IHNjc2lfcG9pbnRlci0+YnVmZmVyLT5sZW5ndGg7DQo+IAkJCQl9DQo+IAkJCX0N
Cj4gCQl9IGVsc2UgaWYgKGZpZm9kYXRhID4gMCkgew0KPiBAQCAtMjA5OSwxNCArMjEzOCwxNSBA
QCBzdGF0aWMgdm9pZCBkYXRhb19pbml0KHN0cnVjdCBTY3NpX0hvc3QgKnNocG50KQ0KPiANCj4g
c3RhdGljIHZvaWQgZGF0YW9fcnVuKHN0cnVjdCBTY3NpX0hvc3QgKnNocG50KQ0KPiB7DQo+ICsJ
c3RydWN0IHNjc2lfcG9pbnRlciAqc2NzaV9wb2ludGVyID0gYWhhMTUyeF9zY3NpX3BvaW50ZXIo
Q1VSUkVOVF9TQyk7DQo+IAl1bnNpZ25lZCBsb25nIHRoZV90aW1lOw0KPiAJaW50IGRhdGFfY291
bnQ7DQo+IA0KPiAJLyogdW50aWwgcGhhc2UgY2hhbmdlcyBvciBhbGwgZGF0YSBzZW50ICovDQo+
IC0Jd2hpbGUoVEVTVExPKERNQVNUQVQsIElOVFNUQVQpICYmIENVUlJFTlRfU0MtPlNDcC50aGlz
X3Jlc2lkdWFsPjApIHsNCj4gKwl3aGlsZSAoVEVTVExPKERNQVNUQVQsIElOVFNUQVQpICYmIHNj
c2lfcG9pbnRlci0+dGhpc19yZXNpZHVhbCA+IDApIHsNCj4gCQlkYXRhX2NvdW50ID0gMTI4Ow0K
PiAtCQlpZihkYXRhX2NvdW50ID4gQ1VSUkVOVF9TQy0+U0NwLnRoaXNfcmVzaWR1YWwpDQo+IC0J
CQlkYXRhX2NvdW50PUNVUlJFTlRfU0MtPlNDcC50aGlzX3Jlc2lkdWFsOw0KPiArCQlpZiAoZGF0
YV9jb3VudCA+IHNjc2lfcG9pbnRlci0+dGhpc19yZXNpZHVhbCkNCj4gKwkJCWRhdGFfY291bnQg
PSBzY3NpX3BvaW50ZXItPnRoaXNfcmVzaWR1YWw7DQo+IA0KPiAJCWlmKFRFU1RMTyhETUFTVEFU
LCBERklGT0VNUCkpIHsNCj4gCQkJc2NtZF9wcmludGsoS0VSTl9FUlIsIENVUlJFTlRfU0MsDQo+
IEBAIC0yMTE3LDI2ICsyMTU3LDI2IEBAIHN0YXRpYyB2b2lkIGRhdGFvX3J1bihzdHJ1Y3QgU2Nz
aV9Ib3N0ICpzaHBudCkNCj4gDQo+IAkJaWYoZGF0YV9jb3VudCAmIDEpIHsNCj4gCQkJU0VUUE9S
VChETUFDTlRSTDAsV1JJVEVfUkVBRHxFTkRNQXxfOEJJVCk7DQo+IC0JCQlTRVRQT1JUKERBVEFQ
T1JULCAqQ1VSUkVOVF9TQy0+U0NwLnB0cisrKTsNCj4gLQkJCUNVUlJFTlRfU0MtPlNDcC50aGlz
X3Jlc2lkdWFsLS07DQo+ICsJCQlTRVRQT1JUKERBVEFQT1JULCAqc2NzaV9wb2ludGVyLT5wdHIr
Kyk7DQo+ICsJCQlzY3NpX3BvaW50ZXItPnRoaXNfcmVzaWR1YWwtLTsNCj4gCQkJQ01EX0lOQ19S
RVNJRChDVVJSRU5UX1NDLCAtMSk7DQo+IAkJCVNFVFBPUlQoRE1BQ05UUkwwLFdSSVRFX1JFQUR8
RU5ETUEpOw0KPiAJCX0NCj4gDQo+IAkJaWYoZGF0YV9jb3VudCA+IDEpIHsNCj4gCQkJZGF0YV9j
b3VudCA+Pj0gMTsNCj4gLQkJCW91dHN3KERBVEFQT1JULCBDVVJSRU5UX1NDLT5TQ3AucHRyLCBk
YXRhX2NvdW50KTsNCj4gLQkJCUNVUlJFTlRfU0MtPlNDcC5wdHIgICAgICAgICAgICs9IDIgKiBk
YXRhX2NvdW50Ow0KPiAtCQkJQ1VSUkVOVF9TQy0+U0NwLnRoaXNfcmVzaWR1YWwgLT0gMiAqIGRh
dGFfY291bnQ7DQo+ICsJCQlvdXRzdyhEQVRBUE9SVCwgc2NzaV9wb2ludGVyLT5wdHIsIGRhdGFf
Y291bnQpOw0KPiArCQkJc2NzaV9wb2ludGVyLT5wdHIgICAgICAgICAgICs9IDIgKiBkYXRhX2Nv
dW50Ow0KPiArCQkJc2NzaV9wb2ludGVyLT50aGlzX3Jlc2lkdWFsIC09IDIgKiBkYXRhX2NvdW50
Ow0KPiAJCQlDTURfSU5DX1JFU0lEKENVUlJFTlRfU0MsIC0yICogZGF0YV9jb3VudCk7DQo+IAkJ
fQ0KPiANCj4gLQkJaWYgKENVUlJFTlRfU0MtPlNDcC50aGlzX3Jlc2lkdWFsID09IDAgJiYNCj4g
LQkJICAgICFzZ19pc19sYXN0KENVUlJFTlRfU0MtPlNDcC5idWZmZXIpKSB7DQo+ICsJCWlmIChz
Y3NpX3BvaW50ZXItPnRoaXNfcmVzaWR1YWwgPT0gMCAmJg0KPiArCQkgICAgIXNnX2lzX2xhc3Qo
c2NzaV9wb2ludGVyLT5idWZmZXIpKSB7DQo+IAkJCS8qIGFkdmFuY2UgdG8gbmV4dCBidWZmZXIg
Ki8NCj4gLQkJCUNVUlJFTlRfU0MtPlNDcC5idWZmZXIgPSBzZ19uZXh0KENVUlJFTlRfU0MtPlND
cC5idWZmZXIpOw0KPiAtCQkJQ1VSUkVOVF9TQy0+U0NwLnB0ciAgICAgICAgICAgPSBTR19BRERS
RVNTKENVUlJFTlRfU0MtPlNDcC5idWZmZXIpOw0KPiAtCQkJQ1VSUkVOVF9TQy0+U0NwLnRoaXNf
cmVzaWR1YWwgPSBDVVJSRU5UX1NDLT5TQ3AuYnVmZmVyLT5sZW5ndGg7DQo+ICsJCQlzY3NpX3Bv
aW50ZXItPmJ1ZmZlciA9IHNnX25leHQoc2NzaV9wb2ludGVyLT5idWZmZXIpOw0KPiArCQkJc2Nz
aV9wb2ludGVyLT5wdHIgICAgICAgICAgID0gU0dfQUREUkVTUyhzY3NpX3BvaW50ZXItPmJ1ZmZl
cik7DQo+ICsJCQlzY3NpX3BvaW50ZXItPnRoaXNfcmVzaWR1YWwgPSBzY3NpX3BvaW50ZXItPmJ1
ZmZlci0+bGVuZ3RoOw0KPiAJCX0NCj4gDQo+IAkJdGhlX3RpbWU9amlmZmllcyArIDEwMCpIWjsN
Cj4gQEAgLTIxNTIsNiArMjE5Miw4IEBAIHN0YXRpYyB2b2lkIGRhdGFvX3J1bihzdHJ1Y3QgU2Nz
aV9Ib3N0ICpzaHBudCkNCj4gDQo+IHN0YXRpYyB2b2lkIGRhdGFvX2VuZChzdHJ1Y3QgU2NzaV9I
b3N0ICpzaHBudCkNCj4gew0KPiArCXN0cnVjdCBzY3NpX3BvaW50ZXIgKnNjc2lfcG9pbnRlciA9
IGFoYTE1Mnhfc2NzaV9wb2ludGVyKENVUlJFTlRfU0MpOw0KPiArDQo+IAlpZihURVNUTE8oRE1B
U1RBVCwgREZJRk9FTVApKSB7DQo+IAkJdTMyIGRhdGFvX2NudCA9IEdFVFNUQ05UKCk7DQo+IAkJ
aW50IGRhdGFvX291dCA9IERBVEFfTEVOIC0gc2NzaV9nZXRfcmVzaWQoQ1VSUkVOVF9TQyk7DQo+
IEBAIC0yMTY5LDkgKzIyMTEsOSBAQCBzdGF0aWMgdm9pZCBkYXRhb19lbmQoc3RydWN0IFNjc2lf
SG9zdCAqc2hwbnQpDQo+IAkJCXNnID0gc2dfbmV4dChzZyk7DQo+IAkJfQ0KPiANCj4gLQkJQ1VS
UkVOVF9TQy0+U0NwLmJ1ZmZlciA9IHNnOw0KPiAtCQlDVVJSRU5UX1NDLT5TQ3AucHRyID0gU0df
QUREUkVTUyhDVVJSRU5UX1NDLT5TQ3AuYnVmZmVyKSArIGRvbmU7DQo+IC0JCUNVUlJFTlRfU0Mt
PlNDcC50aGlzX3Jlc2lkdWFsID0gQ1VSUkVOVF9TQy0+U0NwLmJ1ZmZlci0+bGVuZ3RoIC0NCj4g
KwkJc2NzaV9wb2ludGVyLT5idWZmZXIgPSBzZzsNCj4gKwkJc2NzaV9wb2ludGVyLT5wdHIgPSBT
R19BRERSRVNTKHNjc2lfcG9pbnRlci0+YnVmZmVyKSArIGRvbmU7DQo+ICsJCXNjc2lfcG9pbnRl
ci0+dGhpc19yZXNpZHVhbCA9IHNjc2lfcG9pbnRlci0+YnVmZmVyLT5sZW5ndGggLQ0KPiAJCQlk
b25lOw0KPiAJfQ0KPiANCj4gQEAgLTIxODcsNiArMjIyOSw3IEBAIHN0YXRpYyB2b2lkIGRhdGFv
X2VuZChzdHJ1Y3QgU2NzaV9Ib3N0ICpzaHBudCkNCj4gICovDQo+IHN0YXRpYyBpbnQgdXBkYXRl
X3N0YXRlKHN0cnVjdCBTY3NpX0hvc3QgKnNocG50KQ0KPiB7DQo+ICsJc3RydWN0IHNjc2lfcG9p
bnRlciAqc2NzaV9wb2ludGVyID0gYWhhMTUyeF9zY3NpX3BvaW50ZXIoQ1VSUkVOVF9TQyk7DQo+
IAlpbnQgZGF0YXBoYXNlPTA7DQo+IAl1bnNpZ25lZCBpbnQgc3RhdDAgPSBHRVRQT1JUKFNTVEFU
MCk7DQo+IAl1bnNpZ25lZCBpbnQgc3RhdDEgPSBHRVRQT1JUKFNTVEFUMSk7DQo+IEBAIC0yMjAw
LDcgKzIyNDMsOCBAQCBzdGF0aWMgaW50IHVwZGF0ZV9zdGF0ZShzdHJ1Y3QgU2NzaV9Ib3N0ICpz
aHBudCkNCj4gCQlTRVRQT1JUKFNTVEFUMSxTQ1NJUlNUSSk7DQo+IAl9IGVsc2UgaWYgKHN0YXQw
ICYgU0VMREkgJiYgUFJFVlNUQVRFID09IGJ1c2ZyZWUpIHsNCj4gCQlTVEFURT1zZWxkaTsNCj4g
LQl9IGVsc2UgaWYoc3RhdDAgJiBTRUxETyAmJiBDVVJSRU5UX1NDICYmIChDVVJSRU5UX1NDLT5T
Q3AucGhhc2UgJiBzZWxlY3RpbmcpKSB7DQo+ICsJfSBlbHNlIGlmIChzdGF0MCAmIFNFTERPICYm
IENVUlJFTlRfU0MgJiYNCj4gKwkJICAgKHNjc2lfcG9pbnRlci0+cGhhc2UgJiBzZWxlY3Rpbmcp
KSB7DQo+IAkJU1RBVEU9c2VsZG87DQo+IAl9IGVsc2UgaWYoc3RhdDEgJiBTRUxUTykgew0KPiAJ
CVNUQVRFPXNlbHRvOw0KPiBAQCAtMjMzMiw3ICsyMzc2LDggQEAgc3RhdGljIHZvaWQgaXNfY29t
cGxldGUoc3RydWN0IFNjc2lfSG9zdCAqc2hwbnQpDQo+IAkJCVNFVFBPUlQoU1hGUkNUTDAsIENI
MSk7DQo+IAkJCVNFVFBPUlQoRE1BQ05UUkwwLCAwKTsNCj4gCQkJaWYoQ1VSUkVOVF9TQykNCj4g
LQkJCQlDVVJSRU5UX1NDLT5TQ3AucGhhc2UgJj0gfnNwaW9yZHk7DQo+ICsJCQkJYWhhMTUyeF9z
Y3NpX3BvaW50ZXIoQ1VSUkVOVF9TQyktPnBoYXNlICY9DQo+ICsJCQkJCX5zcGlvcmR5Ow0KPiAJ
CX0NCj4gDQo+IAkJLyoNCj4gQEAgLTIzNTQsNyArMjM5OSw4IEBAIHN0YXRpYyB2b2lkIGlzX2Nv
bXBsZXRlKHN0cnVjdCBTY3NpX0hvc3QgKnNocG50KQ0KPiAJCQlTRVRQT1JUKERNQUNOVFJMMCwg
MCk7DQo+IAkJCVNFVFBPUlQoU1hGUkNUTDAsIENIMXxTUElPRU4pOw0KPiAJCQlpZihDVVJSRU5U
X1NDKQ0KPiAtCQkJCUNVUlJFTlRfU0MtPlNDcC5waGFzZSB8PSBzcGlvcmR5Ow0KPiArCQkJCWFo
YTE1Mnhfc2NzaV9wb2ludGVyKENVUlJFTlRfU0MpLT5waGFzZSB8PQ0KPiArCQkJCQlzcGlvcmR5
Ow0KPiAJCX0NCj4gDQo+IAkJLyoNCj4gQEAgLTI0NDQsMjEgKzI0OTAsMjMgQEAgc3RhdGljIHZv
aWQgZGlzcF9lbmludHIoc3RydWN0IFNjc2lfSG9zdCAqc2hwbnQpDQo+ICAqLw0KPiBzdGF0aWMg
dm9pZCBzaG93X2NvbW1hbmQoc3RydWN0IHNjc2lfY21uZCAqcHRyKQ0KPiB7DQo+ICsJY29uc3Qg
aW50IHBoYXNlID0gYWhhMTUyeF9zY3NpX3BvaW50ZXIocHRyKS0+cGhhc2U7DQo+ICsNCj4gCXNj
c2lfcHJpbnRfY29tbWFuZChwdHIpOw0KPiAJc2NtZF9wcmludGsoS0VSTl9ERUJVRywgcHRyLA0K
PiAJCSAgICAicmVxdWVzdF9idWZmbGVuPSVkOyByZXNpZD0lZDsgIg0KPiAJCSAgICAicGhhc2Ug
fCVzJXMlcyVzJXMlcyVzJXMlczsgbmV4dD0weCVwIiwNCj4gCQkgICAgc2NzaV9idWZmbGVuKHB0
ciksIHNjc2lfZ2V0X3Jlc2lkKHB0ciksDQo+IC0JCSAgICAocHRyLT5TQ3AucGhhc2UgJiBub3Rf
aXNzdWVkKSA/ICJub3QgaXNzdWVkfCIgOiAiIiwNCj4gLQkJICAgIChwdHItPlNDcC5waGFzZSAm
IHNlbGVjdGluZykgPyAic2VsZWN0aW5nfCIgOiAiIiwNCj4gLQkJICAgIChwdHItPlNDcC5waGFz
ZSAmIGlkZW50aWZpZWQpID8gImlkZW50aWZpZWR8IiA6ICIiLA0KPiAtCQkgICAgKHB0ci0+U0Nw
LnBoYXNlICYgZGlzY29ubmVjdGVkKSA/ICJkaXNjb25uZWN0ZWR8IiA6ICIiLA0KPiAtCQkgICAg
KHB0ci0+U0NwLnBoYXNlICYgY29tcGxldGVkKSA/ICJjb21wbGV0ZWR8IiA6ICIiLA0KPiAtCQkg
ICAgKHB0ci0+U0NwLnBoYXNlICYgc3Bpb3JkeSkgPyAic3Bpb3JkeXwiIDogIiIsDQo+IC0JCSAg
ICAocHRyLT5TQ3AucGhhc2UgJiBzeW5jbmVnKSA/ICJzeW5jbmVnfCIgOiAiIiwNCj4gLQkJICAg
IChwdHItPlNDcC5waGFzZSAmIGFib3J0ZWQpID8gImFib3J0ZWR8IiA6ICIiLA0KPiAtCQkgICAg
KHB0ci0+U0NwLnBoYXNlICYgcmVzZXR0ZWQpID8gInJlc2V0dGVkfCIgOiAiIiwNCj4gLQkJICAg
IChTQ0RBVEEocHRyKSkgPyBTQ05FWFQocHRyKSA6IE5VTEwpOw0KPiArCQkgICAgcGhhc2UgJiBu
b3RfaXNzdWVkID8gIm5vdCBpc3N1ZWR8IiA6ICIiLA0KPiArCQkgICAgcGhhc2UgJiBzZWxlY3Rp
bmcgPyAic2VsZWN0aW5nfCIgOiAiIiwNCj4gKwkJICAgIHBoYXNlICYgaWRlbnRpZmllZCA/ICJp
ZGVudGlmaWVkfCIgOiAiIiwNCj4gKwkJICAgIHBoYXNlICYgZGlzY29ubmVjdGVkID8gImRpc2Nv
bm5lY3RlZHwiIDogIiIsDQo+ICsJCSAgICBwaGFzZSAmIGNvbXBsZXRlZCA/ICJjb21wbGV0ZWR8
IiA6ICIiLA0KPiArCQkgICAgcGhhc2UgJiBzcGlvcmR5ID8gInNwaW9yZHl8IiA6ICIiLA0KPiAr
CQkgICAgcGhhc2UgJiBzeW5jbmVnID8gInN5bmNuZWd8IiA6ICIiLA0KPiArCQkgICAgcGhhc2Ug
JiBhYm9ydGVkID8gImFib3J0ZWR8IiA6ICIiLA0KPiArCQkgICAgcGhhc2UgJiByZXNldHRlZCA/
ICJyZXNldHRlZHwiIDogIiIsDQo+ICsJCSAgICBTQ0RBVEEocHRyKSA/IFNDTkVYVChwdHIpIDog
TlVMTCk7DQo+IH0NCj4gDQo+IC8qDQo+IEBAIC0yNDkwLDYgKzI1MzgsOCBAQCBzdGF0aWMgdm9p
ZCBzaG93X3F1ZXVlcyhzdHJ1Y3QgU2NzaV9Ib3N0ICpzaHBudCkNCj4gDQo+IHN0YXRpYyB2b2lk
IGdldF9jb21tYW5kKHN0cnVjdCBzZXFfZmlsZSAqbSwgc3RydWN0IHNjc2lfY21uZCAqIHB0cikN
Cj4gew0KPiArCXN0cnVjdCBzY3NpX3BvaW50ZXIgKnNjc2lfcG9pbnRlciA9IGFoYTE1Mnhfc2Nz
aV9wb2ludGVyKHB0cik7DQo+ICsJY29uc3QgaW50IHBoYXNlID0gc2NzaV9wb2ludGVyLT5waGFz
ZTsNCj4gCWludCBpOw0KPiANCj4gCXNlcV9wcmludGYobSwgIiVwOiB0YXJnZXQ9JWQ7IGx1bj0l
ZDsgY21uZD0oICIsDQo+IEBAIC0yNDk5LDI0ICsyNTQ5LDI0IEBAIHN0YXRpYyB2b2lkIGdldF9j
b21tYW5kKHN0cnVjdCBzZXFfZmlsZSAqbSwgc3RydWN0IHNjc2lfY21uZCAqIHB0cikNCj4gCQlz
ZXFfcHJpbnRmKG0sICIweCUwMnggIiwgcHRyLT5jbW5kW2ldKTsNCj4gDQo+IAlzZXFfcHJpbnRm
KG0sICIpOyByZXNpZD0lZDsgcmVzaWR1YWw9JWQ7IGJ1ZmZlcnM9JWQ7IHBoYXNlIHwiLA0KPiAt
CQlzY3NpX2dldF9yZXNpZChwdHIpLCBwdHItPlNDcC50aGlzX3Jlc2lkdWFsLA0KPiAtCQlzZ19u
ZW50cyhwdHItPlNDcC5idWZmZXIpIC0gMSk7DQo+ICsJCXNjc2lfZ2V0X3Jlc2lkKHB0ciksIHNj
c2lfcG9pbnRlci0+dGhpc19yZXNpZHVhbCwNCj4gKwkJc2dfbmVudHMoc2NzaV9wb2ludGVyLT5i
dWZmZXIpIC0gMSk7DQo+IA0KPiAtCWlmIChwdHItPlNDcC5waGFzZSAmIG5vdF9pc3N1ZWQpDQo+
ICsJaWYgKHBoYXNlICYgbm90X2lzc3VlZCkNCj4gCQlzZXFfcHV0cyhtLCAibm90IGlzc3VlZHwi
KTsNCj4gLQlpZiAocHRyLT5TQ3AucGhhc2UgJiBzZWxlY3RpbmcpDQo+ICsJaWYgKHBoYXNlICYg
c2VsZWN0aW5nKQ0KPiAJCXNlcV9wdXRzKG0sICJzZWxlY3Rpbmd8Iik7DQo+IC0JaWYgKHB0ci0+
U0NwLnBoYXNlICYgZGlzY29ubmVjdGVkKQ0KPiArCWlmIChwaGFzZSAmIGRpc2Nvbm5lY3RlZCkN
Cj4gCQlzZXFfcHV0cyhtLCAiZGlzY29ubmVjdGVkfCIpOw0KPiAtCWlmIChwdHItPlNDcC5waGFz
ZSAmIGFib3J0ZWQpDQo+ICsJaWYgKHBoYXNlICYgYWJvcnRlZCkNCj4gCQlzZXFfcHV0cyhtLCAi
YWJvcnRlZHwiKTsNCj4gLQlpZiAocHRyLT5TQ3AucGhhc2UgJiBpZGVudGlmaWVkKQ0KPiArCWlm
IChwaGFzZSAmIGlkZW50aWZpZWQpDQo+IAkJc2VxX3B1dHMobSwgImlkZW50aWZpZWR8Iik7DQo+
IC0JaWYgKHB0ci0+U0NwLnBoYXNlICYgY29tcGxldGVkKQ0KPiArCWlmIChwaGFzZSAmIGNvbXBs
ZXRlZCkNCj4gCQlzZXFfcHV0cyhtLCAiY29tcGxldGVkfCIpOw0KPiAtCWlmIChwdHItPlNDcC5w
aGFzZSAmIHNwaW9yZHkpDQo+ICsJaWYgKHBoYXNlICYgc3Bpb3JkeSkNCj4gCQlzZXFfcHV0cyht
LCAic3Bpb3JkeXwiKTsNCj4gLQlpZiAocHRyLT5TQ3AucGhhc2UgJiBzeW5jbmVnKQ0KPiArCWlm
IChwaGFzZSAmIHN5bmNuZWcpDQo+IAkJc2VxX3B1dHMobSwgInN5bmNuZWd8Iik7DQo+IAlzZXFf
cHJpbnRmKG0sICI7IG5leHQ9MHglcFxuIiwgU0NORVhUKHB0cikpOw0KPiB9DQo+IEBAIC0yOTIx
LDYgKzI5NzEsNyBAQCBzdGF0aWMgc3RydWN0IHNjc2lfaG9zdF90ZW1wbGF0ZSBhaGExNTJ4X2Ry
aXZlcl90ZW1wbGF0ZSA9IHsNCj4gCS5zZ190YWJsZXNpemUJCQk9IFNHX0FMTCwNCj4gCS5kbWFf
Ym91bmRhcnkJCQk9IFBBR0VfU0laRSAtIDEsDQo+IAkuc2xhdmVfYWxsb2MJCQk9IGFoYTE1Mnhf
YWRqdXN0X3F1ZXVlLA0KPiArCS5jbWRfc2l6ZQkJCT0gc2l6ZW9mKHN0cnVjdCBhaGExNTJ4X2Nt
ZF9wcml2KSwNCj4gfTsNCj4gDQo+ICNpZiAhZGVmaW5lZChBSEExNTJYX1BDTUNJQSkNCg0KUmV2
aWV3ZWQtYnk6IEhpbWFuc2h1IE1hZGhhbmkgPGhpbWFuc2h1Lm1hZGhhbmlAb3JhY2xlLmNvbT4N
Cg0KLS0NCkhpbWFuc2h1IE1hZGhhbmkJIE9yYWNsZSBMaW51eCBFbmdpbmVlcmluZw0KDQo=
